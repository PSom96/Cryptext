<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title> Cryptext Word Puzzle </title>
        <style>
            @font-face {
                font-family: 'Neoneon';
                src: 
                    url("fonts/Neoneon.woff2") format('woff2'),
                    url("fonts/Neoneon.woff") format('woff');
                font-weight: normal;
                font-style: normal;
                font-display: swap;
            }
            h1.gameTitle {
                font-family: "Neoneon";
                font-size: 3rem;
                color: #188678;
                text-align: center;
                margin: 1em 0;
            }
            body {
                font-family: monospace;
                background-color: rgb(248, 243, 237);
                overflow-x: hidden;
		overscroll-behavior-y: contain;
                touch-action: manipulation;
		min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                text-align: center;
            }
            .gameContainer {
                position: relative;
		background-color: bisque;
                border: 2px solid teal;
                border-radius: 12px;
                padding: 40px 30px;
                text-align: center;
                max-width: 350px;
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            }
            .subtitle {
                font-size: 1em;
                margin-bottom: 10px;
            }
            .dateDisplay {
                font-weight: bold;
            }
            .triangleArrowLeft {
                display: inline-block;
                width: 0;
                height: 0;
                border-top: 10px solid transparent;
                border-bottom: 10px solid transparent;
                border-right: 10px solid teal;
                cursor: pointer;
                margin-right: 10px;
                vertical-align: middle;
            }
            .triangleArrowRight {
                display: inline-block;
                width: 0;
                height: 0;
                border-top: 10px solid transparent;
                border-bottom: 10px solid transparent;
                border-left: 10px solid teal;
                cursor: pointer;
                margin-left: 10px;
                vertical-align: middle;
            }
            .dateRow {
                display: flex;
                align-items: center;
                justify-content: center;
                margin-bottom: 20px;
            }          
            .wheelsWrapper {
                display: flex;
                justify-content: center;
                margin-top: 40px;
                position: relative;
                flex-wrap: nowrap;
            }
	    #wheel {                 /*#wheel is the container for all wheels*/ 
                display: flex;
		touch-action: none;
                position: relative;
                height: 250px;
                width: auto;         /* Allow it to grow to fit all wheels */
                min-width: 350px;    /* Or set to 5 * wheel width */
                justify-content: center;
                /* Fade effect at top and bottom */
                mask-image: linear-gradient(to bottom, transparent 0%, black 15%, black 85%, transparent 100%);
                -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 15%, black 85%, transparent 100%);
            }
            .wheelContainer {
                display: flex;
                flex-direction: column;
		touch-action: none;
                align-items: center;
                margin: 0 5px;
		height: 250px;
                width: 50px;            /* Each wheel gets its own width */
                overflow: visible;      /* Allow overflow for the wheel to scroll */
                position: relative;
		outline: none;
                transition: box-shadow 0.2s, border-color 0.2s ease;
            }
            .wheel {
                display: flex;
                flex-direction: column;
                border: 2px solid #222;
                border-radius: 8px;
                background-color: white;
                padding: 10px 0;
		position: relative;
                left: 0;
                right: 0;
                width: 50px;         /* Match wheelContainer width */
                transition: top 0.2s;
                box-sizing: border-box; /* ensures border is included in width/height */
            }
	     .wheel.focused {
                box-shadow: inset 0 3px 3px rgba(71, 22, 22, 0.6), 0 5px 5px rgba(0, 0, 0, 0.6);
            }
            .letter {
                height: 40px;
		width: 46px;
    		line-height: 40px;
    		font-size: 1.2em;
    		text-align: center;
    		color: #bbb;
    		background: transparent;
            }
            .letter.selected {
                color: black;
                font-weight: bold;
                background: #eee;
            }
            .selected {
                font-weight: bold;
                background-color: black;
                color: white;
            }
            .selected.correct {
                background-color: teal;
            }
            #result {
                margin-top: 20px;
                font-size: 0.75em;
                font-weight: lighter;
            }
            #goalCounter {
                font-size: 1.2em;
                margin: 10px 0;
            }
            .bottomRow {
                display: flex;
                justify-content: space-between;
                margin-top: 20px;
                font-size: 1em;
            }
            #congratsDialog {
                display: none;
                position: fixed;
                top: 50%; left: 50%;
                transform: translate(-50%, -50%);
                background-color: whitesmoke; 
                padding: 20px;
                border: 2px solid black; border-radius: 10px;
                z-index: 10;
                width: 80%;
                max-width: 400px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            }
            #overlay {
                display: none;
                position: fixed;
                top: 0; left: 0;
                width: 100vw; height: 100vh;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 9;
            }
            #congratsDialog button {
                margin-top: 15px;
                padding: 10px 20px;
                font-size: 1em;
            }
	    body.darkMode {
                background-color: #121212;
                color: #f0f0f0;
            }
            body.darkMode .gameContainer {
                background-color: #1e1e1e;
                border-color: #00bfa5;
                box-shadow: 0 8px 20px rgba(255, 255, 255, 0.05);
            }
            body.darkMode h1.gameTitle {
                color: #00bfa5;
            }
	    body.darkMode .wheel{
                background-color: #333;
                border-color: #00bfa5;
            }
	    body.darkMode .wheel.focused {
                box-shadow: inset 0 3px 3px rgba(100, 219, 213, 0.7), 0 5px 5px rgba(67, 179, 173, 0.7);
            }
            body.darkMode .letter {
                color: #888;
            }
            body.darkMode .letter.selected {
                color: white;
                background: #333;
            }
            body.darkMode .selected.correct {
                background-color: #00bfa5;
                color: black;
            }
            body.darkMode #congratsDialog {
                background-color: #2c2c2c;
                color: #f0f0f0;
                border-color: #00bfa5;
            }
            .toggleWrapper {
		position: absolute;
		top: 0.5rem;
		right: 0.5rem;
		z-index: 10;
	    }
	    #toggleButton {
		width: 36px;
		height: 36px;
		border-radius: 50%;
		border: none;
		font-size: 18px;
		background-color: #f0f0f0;
		color: #333;
		cursor: pointer;
		box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
		transition: background-color 0.3s, color 0.3s;
	    }
	    body.darkMode #toggleButton {
		background-color: #333;
		color: #f0f0f0;
	    }
        </style>
    </head>
    <body> 
    <div class="gameContainer">
	<div class="toggleWrapper">
  		<button id="toggleButton" aria-label="Toggle dark mode">‚èæ</button>
	</div>
    <h1 class="gameTitle"> Cryptext </h1>
    <p style="font-size: 1em; margin-top: 0; margin-bottom: 20px;"> Select one letter from each wheel <br> to form 5-letter words. </p>

    <div class="dateRow">
        <span id="leftArrow" class="triangleArrowLeft"></span>
        <span class="dateDisplay" id="dateDisplay"></span>
        <span id="rightArrow" class="triangleArrowRight"></span>
    </div>
    
    <div class="wheelsWrapper">
        <div id="wheel" style="display: flex"> </div>
    </div>

    <div>
        <button id="checkButton" 
        style="margin-top: 20px; border: 2px; border-radius: 8px; padding: 10px 20px; background-color: teal; font-size: 1em; color: white"> Check </button>
    </div>

    <div id="result"> </div>

    <div class="bottomRow">
        <div id="goalTarget"> Goal: 0/7 </div>
        <div id="timer">Timer: 00:00 </div>
    </div>
    </div>

    <div id="overlay"></div>
    <div id="congratsDialog">
        <div id="congratsMessage"></div>
        <button id="returnButton">Return to Game</button>
    </div>

    <script>
        document.addEventListener ("DOMContentLoaded", () => {
            const wheel = [
                ['S', 'H', 'O', 'E', 'S'],
                ['T', 'R', 'A', 'C', 'K'],
                ['W', 'A', 'T', 'C', 'H'],
                ['T', 'R', 'A', 'I', 'L'],
                ['W', 'A', 'T', 'E', 'R']
            ];

            const validWords = ['sacra', 'stair', 'stale', 'skate', 'scare', 'orate', 'state', 'ochre', 'stare', 'start', 'scale'];
            const goalTarget = 7;
                let foundWords = new Set ();
                let wordsFound = 0;
            const wheelContainer = document.getElementById('wheel');
            const currentIndexes = wheel.map(() => 0);
	        const result = document.getElementById('result');
            const goalDisplay = document.getElementById('goalTarget');
            const timerDisplay = document.getElementById('timer');
            const checkButton = document.getElementById('checkButton');

            const overlay = document.getElementById('overlay');
            const dialog = document.getElementById('congratsDialog');
            const message = document.getElementById('congratsMessage');
            const returnButton = document.getElementById('returnButton');

            returnButton.addEventListener('click', () => {
            overlay.style.display = 'none';
            dialog.style.display = 'none';
            });	

            function createWheel (i, letters) {
                const container = document.createElement('div');
                container.classList.add('wheelContainer');
                container.style.position = 'relative';
                container.style.height = '250px';
                container.style.overflow = 'hidden';
		container.setAttribute('tabindex', '0'); // make focusable

                const wheelDiv = document.createElement('div');
                wheelDiv.classList.add('wheel');
                wheelDiv.id = `wheel${i}`;
                wheelDiv.style.position = 'absolute';
                wheelDiv.style.top = '0';
                wheelDiv.style.left = '0';
                wheelDiv.style.right = '0';
                wheelDiv.style.transition = 'top 0.2s';

                let panStartY = null;
                let panStartTop = 0;

                // Touch pan events
                wheelDiv.addEventListener('touchstart', (e) => {
                    if (e.touches.length === 1) {
                        panStartY = e.touches[0].clientY;
                        panStartTop = parseInt(wheelDiv.style.top) || 0;
                        wheelDiv.style.transition = 'none';
                    }
                });

                wheelDiv.addEventListener('touchmove', (e) => {
                    if (panStartY === null) return;
                    e.preventDefault();
                    const deltaY = e.touches[0].clientY - panStartY;
                    wheelDiv.style.top = `${panStartTop + deltaY}px`;
                });

                wheelDiv.addEventListener('touchend', (e) => {
                    if (panStartY === null) return;
                    const deltaY = e.changedTouches[0].clientY - panStartY;
                    const letterHeight = 40;
                    let move = Math.round(-deltaY / letterHeight);
                    currentIndexes[i] = (currentIndexes[i] + move + letters.length) % letters.length;
                    wheelDiv.style.transition = 'top 0.2s';
                    panStartY = null;
                    updateWheelDisplay(i);
                });

                // Mouse wheel scroll to move selection (desktop)
                wheelDiv.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const direction = e.deltaY > 0 ? 1 : -1;
                    currentIndexes[i] = (currentIndexes[i] + direction + letters.length) % letters.length;
                    updateWheelDisplay(i);
                });
		    
		container.addEventListener('focus', () => {
                selectedWheelIndex = i;
                updateWheelHighlight();
                });

                // Keyboard navigation
                container.addEventListener('keydown', (e) => {
                    switch (e.key) {
                        case 'ArrowUp':
                            scrollWheel(selectedWheelIndex, -1);
                            break;
                        case 'ArrowDown':
                            scrollWheel(selectedWheelIndex, 1);
                            break;
                        case 'ArrowRight':
                        case 'Tab':
                            e.preventDefault();
                            selectedWheelIndex = (selectedWheelIndex + 1) % wheel.length;
                            document.querySelectorAll('.wheel')[selectedWheelIndex].focus();
                            updateWheelHighlight();
                            break;
                        case 'ArrowLeft':
                            e.preventDefault();
                            selectedWheelIndex = (selectedWheelIndex - 1 + wheel.length) % wheel.length;
                            document.querySelectorAll('.wheel')[selectedWheelIndex].focus();
                            updateWheelHighlight();
                            break;
			case 'Enter':
		                e.preventDefault();
		                checkWord();
		                break;
		         }
                });
		    
                container.appendChild(wheelDiv);
                wheelContainer.appendChild(container);
                updateWheelDisplay(i);
            }

            function renderWheels () {
                wheelContainer.innerHTML = '';
                wheel.forEach((letters, i) => createWheel(i, letters));
            }

            function scrollWheel(wheelIndex, direction) {
                const letters = wheel[wheelIndex];
                currentIndexes[wheelIndex] = (currentIndexes[wheelIndex] + direction + letters.length) % letters.length;
                updateWheelDisplay(wheelIndex);
            }

            function updateWheelDisplay(wheelIndex) {
                const letters = wheel[wheelIndex];
                const display = document.getElementById(`wheel${wheelIndex}`);
                const index = currentIndexes[wheelIndex];

                display.innerHTML = '';

                letters.forEach((letter, i) => {
                    const div = document.createElement('div');
                    div.className = 'letter';
                    div.style.color = i === index ? 'black' : '#bbb';
                    div.style.fontWeight = i === index ? 'bold' : 'normal';
                    div.style.background = i === index ? '#eee' : 'transparent';
                    div.style.textAlign = 'center';
                    div.style.height = '40px';
                    div.style.lineHeight = '40px';
                    if (i === index) div.classList.add('selected');
                    div.textContent = letter;
                    display.appendChild(div);
                });

                // Center the selected letter visually
                display.style.top = `${-index * 40 + 80}px`; // 80px centers the selected letter, adjust as needed
            }

	    function updateWheelHighlight() {
                document.querySelectorAll('.wheel').forEach((container, i) => {
                    container.classList.toggle('focused', i === selectedWheelIndex);
                });
            }

             // Set constant date display
                const dateDisplay = document.getElementById('dateDisplay');
                dateDisplay.textContent = 'AUGUST 6, 2025';

            function checkWord() {
                const word = currentIndexes.map((idx, i) => wheel[i][idx].toLowerCase()).join('');
                const selectedLetters = document.querySelectorAll('.selected');
                selectedLetters.forEach(el => el.classList.remove('correct'));

                if (validWords.includes(word)) {
                if (foundWords.has(word)) {
                    result.textContent = `üôÇ "${word.toUpperCase()}" has already been found!`;
                    result.style.color = 'blue';
                } else {
                    foundWords.add(word);
                    wordsFound++;
                    goalDisplay.textContent = `Goal: ${wordsFound}/${goalTarget}`;
                    selectedLetters.forEach(el => el.classList.add('correct'));
                    result.textContent = `‚úÖ "${word.toUpperCase()}" is a valid word!`;
                    result.style.color = 'green';

                if (wordsFound === goalTarget) {
                    setTimeout(showCongratsDialog, 300);
                }
                }
                } else {
                    result.textContent = `‚ùå "${word.toUpperCase()}" is not valid.`;
                    result.style.color = 'red';
                }
                }
    
            function showCongratsDialog() {
                const remaining = validWords.length - foundWords.size;
                
                if (remaining > 0) {
                    message.innerHTML = `üéâ You've found ${goalTarget} words! A new puzzle will be available tomorrow.<br><br>There are <strong>${remaining}</strong> more words to find. Want to keep playing?`;
                    returnButton.style.display = 'inline-block';
                } else {
                    message.innerHTML = `üéâ Congratulations! You've found all ${goalTarget} words! A new puzzle will be available tomorrow.`;
                    returnButton.style.display = 'none';
                }
                overlay.style.display = 'block';
                dialog.style.display = 'block';
            }

            document.getElementById('leftArrow').addEventListener('click', () => {
            window.location.href = 'Aug 6.html';
            });
            
            //document.getElementById('rightArrow').addEventListener('click', () => {
            //window.location.href = 'Aug 7.html';
            //});

            checkButton.addEventListener('click', checkWord); 

	    // Timer
            let secondsElapsed = 0;
            let timerInterval = setInterval(() => {
                secondsElapsed++;
                const mins = String(Math.floor(secondsElapsed / 60)).padStart(2, '0');
                const secs = String(secondsElapsed % 60).padStart(2, '0');
                timerDisplay.textContent = `Timer: ${mins}:${secs}`;
                }, 1000);

	    // Dark mode toggle button
	    const toggleButton = document.getElementById("toggleButton");
		
	    // Set initial theme
	    function setInitialTheme() {
		const savedTheme = localStorage.getItem("theme");
		
		if (savedTheme) {
		// Use saved preference
		  applyTheme(savedTheme);
		} else {
		// Infer system preference
		  const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
		  applyTheme(prefersDark ? "dark" : "light");
		}
		}
		
	    // Apply theme and update UI
	    function applyTheme(theme) {
		if (theme === "dark") {
		  document.body.classList.add("darkMode");
		  toggleButton.textContent = "‚òÄÔ∏é"; // sun = switch to light
	          toggleButton.setAttribute("aria-label", "Switch to light mode");
		} else {
		  document.body.classList.remove("darkMode");
		  toggleButton.textContent = "‚èæ"; // moon = switch to dark
		  toggleButton.setAttribute("aria-label", "Switch to dark mode");
		}
		
	    localStorage.setItem("theme", theme);
		}
		
	    // Toggle theme on click
	    function toggleTheme() {
		const isDark = document.body.classList.contains("darkMode");
		applyTheme(isDark ? "light" : "dark");
		}
		
	    // Event listener
	    toggleButton.addEventListener("click", toggleTheme);
		
	    // Run on page load
	    setInitialTheme();

	
            renderWheels();
	    updateWheelHighlight();

    });
    </script>
    </body>

</html>

