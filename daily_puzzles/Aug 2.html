<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title> Cryptext Word Puzzle </title>
        <style>
            @font-face {
                font-family: 'Neoneon';
                src: 
                    url("fonts/Neoneon.woff2") format('woff2'),
                    url("fonts/Neoneon.woff") format('woff');
                font-weight: normal;
                font-style: normal;
                font-display: swap;
            }
            h1.gameTitle {
                font-family: "Neoneon";
                font-size: 3rem;
                color: #188678;
                text-align: center;
                margin: 1em 0;
            }
             body {
                font-family: monospace;
                background-color: rgb(248, 243, 237);
                overflow-x: hidden;
		overscroll-behavior-y: contain;
                touch-action: manipulation;
		min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                text-align: center;
            }
            .gameContainer {
                background-color: bisque;
                border: 2px solid teal;
                border-radius: 12px;
                padding: 40px 30px;
                text-align: center;
                max-width: 350px;
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            }
            .subtitle {
                font-size: 1em;
                margin-bottom: 10px;
            }
            .dateDisplay {
                font-weight: bold;
            }
            .triangleArrowLeft {
                display: inline-block;
                width: 0;
                height: 0;
                border-top: 10px solid transparent;
                border-bottom: 10px solid transparent;
                border-right: 10px solid teal;
                cursor: pointer;
                margin-right: 10px;
                vertical-align: middle;
            }
            .triangleArrowRight {
                display: inline-block;
                width: 0;
                height: 0;
                border-top: 10px solid transparent;
                border-bottom: 10px solid transparent;
                border-left: 10px solid teal;
                cursor: pointer;
                margin-left: 10px;
                vertical-align: middle;
            }
            .dateRow {
                display: flex;
                align-items: center;
                justify-content: center;
                margin-bottom: 20px;
            }          
            .wheelsWrapper {
                display: flex;
                justify-content: center;
                margin-top: 40px;
                position: relative;
                flex-wrap: nowrap;
            }
	    #wheel {                 /*#wheel is the container for all wheels*/ 
                display: flex;
		touch-action: none;
                position: relative;
                height: 250px;
                width: auto;         /* Allow it to grow to fit all wheels */
                min-width: 350px;    /* Or set to 5 * wheel width */
                justify-content: center;
                /* Fade effect at top and bottom */
                mask-image: linear-gradient(to bottom, transparent 0%, black 15%, black 85%, transparent 100%);
                -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 15%, black 85%, transparent 100%);
            }
            .wheelContainer {
                display: flex;
                flex-direction: column;
		touch-action: none;
                align-items: center;
                margin: 0 5px;
		height: 250px;
                width: 50px;            /* Each wheel gets its own width */
                overflow: visible;      /* Allow overflow for the wheel to scroll */
                position: relative;
            }
            .wheel {
                display: flex;
                flex-direction: column;
                border: 2px solid #222;
                border-radius: 8px;
                background-color: white;
                padding: 10px 0;
		position: absolute;
                left: 0;
                right: 0;
                width: 50px;         /* Match wheelContainer width */
                transition: top 0.2s;
                box-sizing: border-box; /* ensures border is included in width/height */
            }
            .letter {
                height: 40px;
		width: 46px;
    		line-height: 40px;
    		font-size: 1.2em;
    		text-align: center;
    		color: #bbb;
    		background: transparent;
            }
            .letter.selected {
                color: black;
                font-weight: bold;
                background: #eee;
            }
            .selected {
                font-weight: bold;
                background-color: black;
                color: white;
            }
            .selected.correct {
                background-color: teal;
            }
            #result {
                margin-top: 20px;
                font-size: 0.75em;
                font-weight: lighter;
            }
            #goalCounter {
                font-size: 1.2em;
                margin: 10px 0;
            }
            .bottomRow {
                display: flex;
                justify-content: space-between;
                margin-top: 20px;
                font-size: 1em;
            }
            #congratsDialog {
                display: none;
                position: fixed;
                top: 50%; left: 50%;
                transform: translate(-50%, -50%);
                background-color: whitesmoke; 
                padding: 20px;
                border: 2px solid black; border-radius: 10px;
                z-index: 10;
                width: 80%;
                max-width: 400px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            }
            #overlay {
                display: none;
                position: fixed;
                top: 0; left: 0;
                width: 100vw; height: 100vh;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 9;
            }
            #congratsDialog button {
                margin-top: 15px;
                padding: 10px 20px;
                font-size: 1em;
            }
        </style>
    </head>
    <body> 
    <div class="gameContainer">
    <h1 class="gameTitle"> Cryptext </h1>
    <p style="font-size: 1em; margin-top: 0; margin-bottom: 20px;"> Select one letter from each wheel <br> to form 5-letter words. </p>

    <div class="dateRow">
        <span id="leftArrow" class="triangleArrowLeft"></span>
        <span class="dateDisplay" id="dateDisplay"></span>
        <span id="rightArrow" class="triangleArrowRight"></span>
    </div>
    
    <div class="wheelsWrapper">
        <div id="wheel" style="display: flex"> </div>
    </div>

    <div>
        <button id="checkButton" 
        style="margin-top: 20px; border: 2px; border-radius: 8px; padding: 10px 20px; background-color: teal; font-size: 1em; color: white"> Check </button>
    </div>

    <div id="result"> </div>

    <div class="bottomRow">
        <div id="goalTarget"> Goal: 0/8 </div>
        <div id="timer">Timer: 00:00 </div>
    </div>
    </div>

    <div id="overlay"></div>
    <div id="congratsDialog">
        <div id="congratsMessage"></div>
        <button id="returnButton">Return to Game</button>
    </div>

    <script>
        document.addEventListener ("DOMContentLoaded", () => {
            const wheel = [
                ['S', 'E', 'R', 'V', 'I', 'C', 'E',],
                ['C', 'O', 'U', 'R', 'T',],
                ['R', 'A', 'C', 'K', 'E', 'T',],
                ['B', 'O', 'U', 'N', 'C', 'E',],
                ['R', 'A', 'L', 'L', 'Y',]
            ];

            const validWords = ['surer', 'steer', 'steel', 'error', 'rotor', 'voter', 'corny', 'cocoa', 'cuter'];
            const goalTarget = 8;
                let foundWords = new Set ();
                let wordsFound = 0;
            const wheelContainer = document.getElementById('wheel');
            const currentIndexes = wheel.map(() => 0);
	        const result = document.getElementById('result');
            const goalDisplay = document.getElementById('goalTarget');
            const timerDisplay = document.getElementById('timer');
            const checkButton = document.getElementById('checkButton');

            const overlay = document.getElementById('overlay');
            const dialog = document.getElementById('congratsDialog');
            const message = document.getElementById('congratsMessage');
            const returnButton = document.getElementById('returnButton');

            returnButton.addEventListener('click', () => {
            overlay.style.display = 'none';
            dialog.style.display = 'none';
            });	

            function createWheel (i, letters) {
                const container = document.createElement('div');
                container.classList.add('wheelContainer');
                container.style.position = 'relative';
                container.style.height = '250px';
                container.style.overflow = 'hidden';

                const wheelDiv = document.createElement('div');
                wheelDiv.classList.add('wheel');
                wheelDiv.id = `wheel${i}`;
                wheelDiv.style.position = 'absolute';
                wheelDiv.style.top = '0';
                wheelDiv.style.left = '0';
                wheelDiv.style.right = '0';
                wheelDiv.style.transition = 'top 0.2s';

                let panStartY = null;
                let panStartTop = 0;

                // Touch pan events
                wheelDiv.addEventListener('touchstart', (e) => {
                    if (e.touches.length === 1) {
                        panStartY = e.touches[0].clientY;
                        panStartTop = parseInt(wheelDiv.style.top) || 0;
                        wheelDiv.style.transition = 'none';
                    }
                });

                wheelDiv.addEventListener('touchmove', (e) => {
                    if (panStartY === null) return;
                    e.preventDefault();
                    const deltaY = e.touches[0].clientY - panStartY;
                    wheelDiv.style.top = `${panStartTop + deltaY}px`;
                });

                wheelDiv.addEventListener('touchend', (e) => {
                    if (panStartY === null) return;
                    const deltaY = e.changedTouches[0].clientY - panStartY;
                    const letterHeight = 40;
                    let move = Math.round(-deltaY / letterHeight);
                    currentIndexes[i] = (currentIndexes[i] + move + letters.length) % letters.length;
                    wheelDiv.style.transition = 'top 0.2s';
                    panStartY = null;
                    updateWheelDisplay(i);
                });

                // Mouse wheel scroll to move selection (desktop)
                wheelDiv.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const direction = e.deltaY > 0 ? 1 : -1;
                    currentIndexes[i] = (currentIndexes[i] + direction + letters.length) % letters.length;
                    updateWheelDisplay(i);
                });

                container.appendChild(wheelDiv);
                wheelContainer.appendChild(container);
                updateWheelDisplay(i);
            }

            function renderWheels () {
                wheelContainer.innerHTML = '';
                wheel.forEach((letters, i) => createWheel(i, letters));
            }

            function scrollWheel(wheelIndex, direction) {
                const letters = wheel[wheelIndex];
                currentIndexes[wheelIndex] = (currentIndexes[wheelIndex] + direction + letters.length) % letters.length;
                updateWheelDisplay(wheelIndex);
            }

            function updateWheelDisplay(wheelIndex) {
                const letters = wheel[wheelIndex];
                const display = document.getElementById(`wheel${wheelIndex}`);
                const index = currentIndexes[wheelIndex];

                display.innerHTML = '';

                letters.forEach((letter, i) => {
                    const div = document.createElement('div');
                    div.className = 'letter';
                    div.style.color = i === index ? 'black' : '#bbb';
                    div.style.fontWeight = i === index ? 'bold' : 'normal';
                    div.style.background = i === index ? '#eee' : 'transparent';
                    div.style.textAlign = 'center';
                    div.style.height = '40px'; // px, adjust as needed
                    div.style.lineHeight = '40px';
                    if (i === index) div.classList.add('selected');
                    div.textContent = letter;
                    display.appendChild(div);
                });

                // Center the selected letter visually
                display.style.top = `${-index * 40 + 80}px`; // 80px centers the selected letter, adjust as needed
            }

             // Set constant date display
                const dateDisplay = document.getElementById('dateDisplay');
                dateDisplay.textContent = 'AUGUST 2, 2025';
		
	    // Timer
            let secondsElapsed = 0;
            let timerInterval = setInterval(() => {
                secondsElapsed++;
                const mins = String(Math.floor(secondsElapsed / 60)).padStart(2, '0');
                const secs = String(secondsElapsed % 60).padStart(2, '0');
                timerDisplay.textContent = `Timer: ${mins}:${secs}`;
                }, 1000);

            function checkWord() {
                const word = currentIndexes.map((idx, i) => wheel[i][idx].toLowerCase()).join('');
                const selectedLetters = document.querySelectorAll('.selected');
                selectedLetters.forEach(el => el.classList.remove('correct'));

                if (validWords.includes(word)) {
                if (foundWords.has(word)) {
                    result.textContent = `🙂 "${word.toUpperCase()}" has already been found!`;
                    result.style.color = 'blue';
                } else {
                    foundWords.add(word);
                    wordsFound++;
                    goalDisplay.textContent = `Goal: ${wordsFound}/${goalTarget}`;
                    selectedLetters.forEach(el => el.classList.add('correct'));
                    result.textContent = `✅ "${word.toUpperCase()}" is a valid word!`;
                    result.style.color = 'green';

                if (wordsFound === goalTarget) {
                    setTimeout(showCongratsDialog, 300);
                }
                }
                } else {
                    result.textContent = `❌ "${word.toUpperCase()}" is not valid.`;
                    result.style.color = 'red';
                }
                }
    
            function showCongratsDialog() {
                const remaining = validWords.length - foundWords.size;
                
                if (remaining > 0) {
                    message.innerHTML = `🎉 You've found ${goalTarget} words! A new puzzle will be available tomorrow.<br><br>There are <strong>${remaining}</strong> more words to find. Want to keep playing?`;
                    returnButton.style.display = 'inline-block';
                } else {
                    message.innerHTML = `🎉 Congratulations! You've found all ${goalTarget} words! A new puzzle will be available tomorrow.`;
                    returnButton.style.display = 'none';
                }
                overlay.style.display = 'block';
                dialog.style.display = 'block';
            }

            document.getElementById('leftArrow').addEventListener('click', () => {
            window.location.href = 'Aug 1.html';
            });
            
            document.getElementById('rightArrow').addEventListener('click', () => {
            window.location.href = 'Aug 3.html';
            });

            checkButton.addEventListener('click', checkWord); 
            
            renderWheels();

    });
    </script>
    </body>

</html>







